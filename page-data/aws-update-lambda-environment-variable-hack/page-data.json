{"componentChunkName":"component---src-templates-blog-template-js","path":"/aws-update-lambda-environment-variable-hack","result":{"data":{"markdownRemark":{"html":"<p>Sometimes we need to save/update environment variables, suppose you have a small set of data and you do not want to save it on external services like S3, DynamoDB</p>\n<p>And you might think create a code likes this:</p>\n<pre><code>  process.env[\"my_var_1\"] = \"something\";\n  process.env[\"my_var_2\"] = \"something_different\";\n</code></pre>\n<p>But each time you run AWS lambda, it will create an isolated environments so you can not set environment variables likes the example above.</p>\n<p>After spend some minutes, I am able to make it works. The hacky way is we can use lambda update function configuration to update environment variable. Here is my example with Nodejs (you can use any language just Google lambda update function configuration + your SDK): </p>\n<ol>\n<li>Create a lambda function with any name that you like for example: test-update-env</li>\n<li>Paste the code below to your function:</li>\n</ol>\n<pre><code>  const AWS = require('aws-sdk');\n  const lambda = new AWS.Lambda();\n\n  exports.handler = async(event) => {\n      const params = {\n      FunctionName: \"test-update-env\",\n      Environment: {\n          Variables: {\n          'MY_VAR_1': 'Foo', // Set process.env.MY_VAR_1 = 'Foo'\n          }\n      },\n      };\n      await lambda.updateFunctionConfiguration(params).promise();\n      const response = {\n      statusCode: 200,\n      body: JSON.stringify('Update env successfully!'),\n      };\n      return response;\n  };\n</code></pre>\n<ol start=\"3\">\n<li>Now run this function and press F5 and you can see the function now has environment variable <code>MY_VAR_1</code> with value: <code>Foo</code></li>\n<li>Modify the code a bit:</li>\n</ol>\n<pre><code>  const AWS = require('aws-sdk');\n  const lambda = new AWS.Lambda();\n\n  exports.handler = async(event) => {\n      const params = {\n      FunctionName: \"test-update-env\",\n      Environment: {\n          Variables: {\n          'MY_VAR_1': 'New Foo', // update process.env.MY_VAR_1 = 'New Foo'\n          'MY_VAR_2': 'Bar', // Set process.env.MY_VAR_2 = 'Bar'\n          }\n      },\n      };\n      await lambda.updateFunctionConfiguration(params).promise();\n      const response = {\n      statusCode: 200,\n      body: JSON.stringify('Update env successfully!'),\n      };\n      return response;\n  };\n</code></pre>\n<ol start=\"5\">\n<li>Now run this again and you can see the function now has updated environment variable <code>MY_VAR_1</code> with a new value: <code>New foo</code> and new environment variable <code>MY_VAR_2</code> with value: <code>Bar</code></li>\n</ol>\n<p>Now you get the idea, you can get any value likes token from API call, calendar/booking data, ... and set/update it to environment variables.</p>","frontmatter":{"date":"October 20, 2020","slug":"aws-update-lambda-environment-variable-hack","title":"AWS update lambda environment hack"}}},"pageContext":{"slug":"aws-update-lambda-environment-variable-hack"}},"staticQueryHashes":[]}